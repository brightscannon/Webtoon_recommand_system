# Webtoon_recommand_system (웹툰 분석 & 추천시스템)

#### Project maker : Bright Kim(김민우), Juno Kim(김준호)
--- 
# *introduce.*
- 소개 : 웹툰의 데이터를 활용한 사용자 웹툰 추천 시스템을 구현하는 프로젝트입니다.

- [X] 데이터 수집
  - 웹툰의 기본정보 데이터
  - 웹툰의 회차별 데이터
  - 웹툰의 회차별 댓글 데이터
  - 웹툰의 이미지 및 회차별 썸네일이미지

- [ ] 데이터 분석
  - 댓글 및 장르 분석을 통한 유저의 성향 분석
  - 각 회차별 분석을 통한 웹툰회차별 관계정도 파악 
  - 신경망을 통한 웹툰 썸네일 분석 -> 썸네일의 종류에 따른 유저 호감도 및 반응 경향 분석
  - 유사도 관계도 분석
  
- [ ] 추천시스템
  - 모델 importance 분석결과를 추천가중치 산정시 적용
  - 유클리드 유사도 / 코사인 유사도 선정
  - 사용자기반 or 아이템기반 협업 필터링 적용 예정
  
--- 
# --**EDA.**--
- DAUM EDA ipnyb 문서 참조
- 

---
# --**현재 진행중인 부분**--

## 1. # EDA결론 및 모델링 사전정의
> - (상세설명은 Daum EDA문서 참조)
> - A. 장르 --> classification Y --> proba로 판단하기?
> - B. 추천수 --> regression Y --> 각 웹툰을 모두 regression 진행하여 가장 좋은 모델 선정 후 이를 장르 classification에 반영
> - C. 댓글반응수 --> regression Y --> 시도할 필요성...
> - D. 시간/회차 --> 독립변수 X --> 시계열?? 
> - E. 썸네일이미지 --> 작가&장르 neuralnet --> 시도해보아야함

## 2. 추천시스템은 어떻게 만들 것인가?
> #### - 2018-09-12 논의
> 1. 독점구분 알고리즘 (왜?? : 너무 많은 추천수는 이미 대부분의 추천대상 유저들도 본 웝툰이라고 판단, 신규유저에게는 추천)
> 2. 추천시스템 입력값 
>    - 웹툰을 즐겨보는 정도?([없음, 근 1년안에, 과거에], [1~3개, 4~7개, 8~12개, 많이] 봄)
>    - 원하는 그림체 선택(이미지 클러스터링으로 구분된 것들중 중심값에 가장 근접한 이미지를 제공, 그중에서 선택받는다)
>    - 선호하는 이야기방식(주장르)선택
>    - 선호하는 내용 (소주제 및 텍스트분석 키워드) 선택
>    - 선호하는 댓글반응 선택(댓글 텍스트 분석 키워드 or 댓글 클러스터링 중심값+추천수 상위권)
>    - 댓글서비스를 즐겨쓰는 이유 : 공감, 응원, 유머, 드립, 욕 // 댓글을 쓰기위해, 댓글을 보기위해
> 3. 회사의중이 반영된 필터링(기타 웹툰제공 회사에서 원하는 방향으로 상품이 추천되도록 하는 방법, 가중치를 줘서 적용된다.)
>    - 회사에서 마케팅이나 기획적으로 밀고있는 프로젝트가 있는 경우
>    - 쏠림방지를 위한 고른 웹툰 추천 (한쪽으로 인기가 쏠리면 회사입장에서는 서비스 불확실성이 커진다)

## 3. TF-idf를 통한 웹툰정보 종합텍스트의 유사도 추출모델 제작, 협업필터요소 모델링
>  - 유의한 결과를 내는편, 막바지단계
## 4. 이미지 신경망 분류모델을 변형한 유사도 추출모델 제작, 협업필터요소 모델링
>  - 진행중

## 5. ★ 이후 계획 정리 :+1:

> #### - 2018-09-18 논의
>    1. 전체 개발흐름 : `웹툰 데이터를 활용한 추천`,`텍스트 데이터 유사도를 통한 추천`,`썸네일 이미지 클러스터링 분류를 통한 추천`,`전체통합 추천시스템`
>    2. 이미지 데이터 분류를 위한 아이디어 도출
>      - a. 이미지 분류 및 테스트 데이터 생성 : 공지,휴재용 이미지 제거 --> 이미지 오그멘테이션
>      - b-1. 클러스터링 먼저할 경우 : `(대표이미지or전체이미지) kmeans등의 클러스터링 (라벨링 시도 or 클러스터 모델 시도)`--> `(거리가 가까운 다른 클러스터)의 그림체들 확인`
>        - --> 1안) `바로 클러스터의 거리를 계산하여 모든 웹툰의 클러스터 거리수치를 추출` --> `가까운 순으로 나열 후 추천`
>        - --> 2안) `각 웹툰별로 클러스터의 센트로이드를 정한 새로운 대표 클러스터를 찍음` --> `그 클러스터 간의 거리를 재고 가까운 순으로 나열` !단 대표클러스터의 센트로이드는 평균할수도 있고, 알고리즘을 따로 제작하여 계산한 결과를 바탕으로 해도 된다.
>      - b-2. 이미지 classification 먼저 할 경우 : `id값 기준 신경망분류모델 생성 및 최적화`
>        - --> 1안)`모델에 선호이미지 직접 삽입` --> `모델이 가장 흡사한 웹툰의 id를 예측하여 proba로 뿌리고 그중 값이 높은것 위주로 추천(가중치)` 
>        - --> 2안)`DC-GAN으로 이미지 생성 및 강화학습` --> `생성 이미지 클러스터링 및 비슷한 이미지로 집합 분류` --> `해당 웹툰들의 실제 그림체 확인`
>    3. 기본정보 데이터를 모델링 --> 추천시스템화

> #### - 2018-09-20 논의
```
웹툰 추천시스템

테이블 작성
0) 작가 정보 (작가 id, 작가명)
1) 웹툰 정보(웹툰 고유id=title id, 웹툰명, 작가명, 주장르, 서브장르, 평점, 다음/네이버, 크롤링 시간대, 하트 갯수, 메인링크, 이미지링크(이미지 분석시 필요), 성인유무)
2) 댓글 (웹툰명, 회차, 댓글길이, 댓글유저명, 댓글내용)
3) 웹툰회차 (웹툰명, 회차, 회차별 썸네일링크)

Row : item
columns(웹툰의 특성) : 작가, 회차별 이미지(그림체 파악, 클러스터링), 추천수, 총 댓글수, 장르, 이야기흐름?(댓글로 뽑아볼만한 특성)

생각해봐야할 것들
- 회차별 이미지를 딥러닝에 어떻게 적용을 할 것인지 --> 선제적으로 tensorflow/keras를 통한 cnn을 계획, 이후 resnet 고려중
- 회차별 댓글에서 어떤 feature를 끌어낼 수 있을지 --> 
```

---
# *Project Time line.*

### ◆ 2018-10-16(Tue) 예정
> #### 주제 : 품질평가, 댓글유사도, 사용자유사도 모델링 및 추천시스템화
>  (장소 : 스타벅스 리저브 이수역 2번출구)
>  - **추천시스템 설계 및 구현**
>    1. 기존 AWS EC2의 Flask에서 서비스 제공하는것을 기본 골자로 함
>    2. 추천시스템은 장르/키워드, 썸네일이미지분석, 댓글분석, 품질필터를 통한 협업필터모델로 제작할 계획
>    3. 각 요소별로 유사한 웹툰을 찾을 수 있도록 선택적인 추천도 고려중 --> 키워드검색, 이미지 업로드 및 비교검색, 댓글반응 및 분위기검색
>    4. 웹 서비스에서는 이용자가 8번 이내의 터치와 2번이내의 화면전환을 통해 웹툰을 추천 받을 수 있도록 서비스 제공 
>    5. 서비스에서 추천한 사람들의 form 작성 정보를 다시 크롤링하여 추천시스템의 추천파라미터 보정에 활용
>  - **썸네일 이미지 분류 신경망을 활용한 웹툰간 이미지 유사도 측정모델**
>    - 모델화 및 사이트 서비스화 작업 실시
>  - **전체 이미지 분류 모델링 결과 discussion**
>  - `대분류 분석 종류`
>    - 성향 : [X]장르/키워드, [X]썸네일이미지, [ ]댓글유사도, [ ][댓글이용자유사도]
>    - 품질 : 추천(댓수)경향성, 추천반응, 별점평균, [댓글감정])


### ◆ 2018-10-08(Mon)
> #### 주제 : 이미지 분석/분류 모델 검증 및 품질평가 // 추천시스템 서비스 (테스트버전) 회의
>  (장소 : 스타벅스 리저브 이수역 2번출구)
>  - 추천시스템 설계 : 추천시스템 구현에 대한 회의, 사이트맵 구성 설계, 각 서비스 화면 폼 구상하기, 서비스 제공의 모토(??) 정하기
>  - 썸네일 이미지 분류 신경망을 활용한 웹툰간 이미지 유사도 측정모델
>    - 현재상황 : CNN에 softmax의 proba를 활용한 웹툰간 유사성 찾기 => 유의미한 결과
>      - 다른 이미지를 넣으면 유사한 이미지를 proba값을 높게 줌 --> 육안상 비슷한 웹툰의 proba가 높게 주어지는것으로 평가됨!
>    - 이미지 분류 모델링 결과 discussion
>      - 현재 어느정도 분류는 하고 있으니 전체 웹툰을 상대로 모델링 하는 과정 필요 --> 이미지 전처리 및 학습용 이미지 선별작업
>      - 그림체를 구별할 수 있는 이미지를 받아서 그에대한 유사도 및 추천 이미지를 보여주는 방식 사용
>    - **이후계획 : D사 N사 전체 이미지 데이터를 적용하여 학습시키고 모델 추출 및 검증**
>  
>  - `대분류 분석 종류`
>    - 성향 : [X]장르/키워드, [X]썸네일이미지, [ ]댓글유사도, [ ][댓글이용자유사도]
>    - 품질 : 추천(댓수)경향성, 추천반응, 별점평균, [댓글감정])
>
>  - ※ 다음 모임까지 할것 : 
>    - 댓글 이용자 유사도 및 댓글자체 유사도에 따른 추천시스템 설계 및 모델링(D사)
>    - 품질평가의 기준에 대한 주장을 위해 기준과 근거자료가 필요함 --> 평가기준을 세우고 알아봐야할듯.
>    - Flask로 기본 웹사이트 틀 만들어보기 (할 수 있는데로!)
>    - 분석용 컴퓨터 환경설정(GTX 960, core i7 텐서플로 학습 가능하도록 세팅)

### ◆ 2018-10-04(Thu)
> #### 주제 : 기초모델 제작 및 텍스트 데이터 및 이미지 분석/분류
>  (장소 : 스타벅스 숭실대역 4번출구)
>  - GPU활용 이슈 -- 모델의 학습성능 향상됨
>  - 썸네일 이미지 분류 신경망 계속 만들고 비슷한 이미지를 높은 proba로 예측하는지 확인
>    - D사 웹툰 : CNN에 softmax의 proba를 활용한 웹툰간 유사성 찾기 => 유의미한 결과를 냄
>    - N사 웹툰 : CNN 신경망의 전처리 필터만 거친 데이터를 유클리드, 코사인 유사도로 유사성 찾기 => 그냥 CNN하는걸로...? 
>  - 이미지 분류 모델링 결과 discussion 및 상호 모델링 설명
>    - 현재까지 가장 유의한 모델은 CNN으로 proba추출 및 웹툰별로 평균하여 pivot후 유사도를 측정하는 변형모델
>    - 의논결과
>      - GPU사용을 할 수 있으면 좋을텐데.. 방법 모색중 [N사 CNN계획(성능이슈...)]
>      - CNN을 활용한 이미지 클러스터링 방법 모색
>      - 이미지 사이즈 : 40x32로 유의한 결과 확인, 64x64이미지세트로 정밀한 이미지유사도 측정모델 제작예정
>      - batch normalize, learning rate 이슈 : 정규화 적용시 학습속도 및 학습능률 향상 기대, 다음시간까지 테스트 예정
>  - `대분류 분석 종류`
>    - 성향 : [X]장르/키워드, [X]썸네일이미지, [ ]댓글유사도, [ ][댓글이용자유사도]
>    - 품질 : 추천(댓수)경향성, 추천반응, 별점평균, [댓글감정])


### ◆ 2018-10-01(Mon)
> #### 주제 : 텍스트 데이터 유사도 모델링 결과 회의 및 이미지 분석/분류 모델링 협의 및 제작작업
>  (장소 : 스타벅스 사당역 13번출구)
>  - 장르/키워드 (텍스트 유사도)모델링 결과 discussion 및 상호 모델링 설명 (TF-idf 방식의 유효성 일부 검증)
>  - `대분류 분석 종류`
>    - 성향 : 장르/키워드, 썸네일이미지, 댓글유사도, [댓글이용자유사도]
>    - 품질 : 추천(댓수)경향성, 추천반응, 별점평균, [댓글감정])
>  - 이미지 CNN 모델링 및 학습
>    - 진행상황 : 테스트용 이미지 전처리및 적용 size(40x32 50개 웹툰, 64x64 전체 웹툰)
>      - 학습방법 
>        - 1. 대표이미지만 오그멘테이션하여 트레인 set 생성 후 학습(N사 웹툰에 적용중)
>        - 2. 전체 회차 이미지의 Y값을 해당 웹툰의 id로 하여 트레인 set생성 후 학습 (D사 웹툰에 적용중)
>      - 검증방법
>        - 1. proba값으로 나온 예측값을 "평균내어" 각 웹툰별 상위 10개를 추려서 실제로 해당 웹툰들을 육안확인, 비슷한느낌인지 보기
>        - 2. proba값으로 나온 예측값을 실제 예측한 회차이미지와 웹툰의 이미지들을 직접 대조하여 육안확인, 비슷한느낌인지 보기
>    - 해결해야할 점 : GPU를 통한 성능향상이 있다면 트레이닝 set을 더 키워서 시도할 수 있음
>      - ====> 노트북 내장 Geforce 940MX로 30배 속도개선

### ◆ 2018-09-20(Thu)
> #### 주제 : 추천시스템을 위한 데이터의 추천요소화 및 분석모델의 사용방향 회의
>  (장소 : 스타벅스 가산디지털단지)
>  - 댓글 텍스트 웹툰별 토큰 유사도 측정 및 유효성 판단
>  - 웹툰 기본정보(장르, 추천수, 댓글수, 시간/회차, 유료/무료, 작가 등)를 활용한 웹툰 예측 모델 회의
>  - 웹툰 이미지 및 댓글정보를 활용한 웹툰 예측모델 
```
2018.09.20
- 먼저, 성향과 품질로 개요를 나눈다.
- 성향은 
	1. 장르 + 웹툰 소개글 : 먼저 '최근 재밌게 본 웹툰'을 물어보고 --> 이 웹툰의 장르 + 소개글의 tf-idf score를 뽑아서 장르관련 컬럼으로 배치하여 이제부터 유사도 분석시작
	2. 그림체 : 사람마다 선호하는 그림체가 다를 수 있다.
- 품질은
	1. 추천수의 경향성(각도,상관계수) : 스토리가 탄탄한지의 여부를 볼 수 있을 것 같다.
	2. 추천반응 : 갑자기 추천수가 확 튀는?...이게 몇개인지
	3. 별점통계 : 9.8과 9.9의 차이를 어떻게 벌릴 것인가...자체함수만들기

- content-based filtering의 평가지표 알아보기
```
>  - 다음주까지 할것
>    - 텍스트 데이터 및 이미지 분석/분류
>    - 기초모델 제작 후 모델에 대한 인사이트 얻기
>    - 추천시스템의 평가지표 모색
>    - 추천시스템 및 이미지,텍스트 신경망 모델 찾고 학습하기

### ◆ 2018-09-18(Tue)
> #### 주제 : 웹툰 댓글 토큰화 및 이미지 데이터 수집/정제/분류
>  (장소 : 스타벅스 청담영동대로점)
>  - 댓글 및 이미지 수집/정형화
>>    - 댓글
>>      - DB 크롤링 댓글데이터 사용
>>      - Konlpy의 Okt(OpenKoreanText)모델(Twitter) 사용, 댓글을 웹툰별/회차별로 Tokenize후 DB저장
>>        - TF-IDF의 변형 모델로 분석 [좋아요,싫어요,베스트 등의 요소를 가중치로 계산한 값을 사용]
>>        - ▶ Issue : TF-IDF 개념이라면 1개 문서단위를 어떻게 볼 것인가? [댓글별, 회차별, 웹툰별(유력)]
>>    - 이미지
>>      - DB 크롤링된 이미지URL 사용, 웹툰별 대표 img 및 회차들의 썸네일img 수집
>>      - 200x150으로 이미지 리사이징, 컬러, 흑백 데이터화
>  - N사 : 썸네일 이미지 추가 확보 및 리사이징
>  - 뉴럴넷 이미지 분석 연구중...
>  - **프로젝트 방향성 중간점검**

### ◆ 2018-09-14(Fri)
> #### 주제 : 웹툰 관련 데이터 EDA
>  (장소 : 스타벅스 강남점)
>  - EDA (각종 시각화 및 피쳐의 영향도 분석)
>  - Feature Engineering
>  - Y값 선정 (추천수or댓글수)
>  - 썸네일 이미지 확보 및 뉴럴넷 이미지 분석 연구

### ◆ 2018-09-12(Wed)
> #### 주제 : 웹툰 관련 데이터 EDA 및 Data Featuring
>  (장소 : 스타벅스 학동역점)
>  - EDA (각종 시각화 및 피쳐의 영향도 분석)
>    - N사 : 인기웹툰 vs 비인기웹툰을 장르별로 비중 %로 분석
>    - D사 : 추천수/댓글수 - 시간/회차 그래프 분석 
>  - N사웹툰 : 추천수 수집
>  - Feature Engineering
>  - Y값 선정 (장르, 추천수)
>  - 다음모임까지 각자 할것
>    - Y값 분석법 연구(회귀분석, 시계열, 분류모델 등)
>    - 추천시스템의 작동방식 연구(추천수의 추이, 장르선택, 화풍선택, 댓글의 성향 등의 협업 논의)
>    - 썸네일 이미지 확보 및 분석법 연구

### ◆ 2018-09-06(Thr)
> #### 주제 : 웹툰 관련 데이터 EDA 및 Data Featuring
>  (장소 : 스타벅스 학동역점)
>  - EDA (각종 시각화 및 피쳐의 영향도 분석)
>    -  D사 웹툰 : 유료웹툰과 무료웹툰의 시간별, 회차별 추천수, 댓글수 분석 및 시각화
>  - N사 웹툰 : 댓글 크롤링 및 DB정리
>  - Feature Engineering
>  - 텍스트 Data 처리방법 모색 및 분석 전략 수립
>  - 다음 모임까지 각자 할것
>    - D사 EDA 및 Feature Engeneering
>    - N사 댓글갯수 데이터 수집 및 EDA

### ◆ 2018-09-05(Wed)
> #### 주제 : 웹툰 관련 데이터 EDA 및 Data Featuring
>  (장소 : 스타벅스 학동역점)
>  - 크롤링 Data --> AWS RDS로 이전, 쿼리로 필요한 데이터 그때그때 불러오는 방식으로 분석
>  - Feature Engineering
>  - 다음 모임까지 각자 할것
>    - 수집데이터 중 댓글 갯수 추가
>    - 댓글양이 많아서 (D사 댓글양 1000만개, N사 댓글양 2억개 예상) 쿼리 튜닝 연구
>    - 추천시스템의 방향 선정 - Item, User based 중 Item based 협업방식 도입 유력

### ◆ 2018-09-03(Mon)
> #### 주제 : 웹툰 Data Featuring
>  (장소 : 스타벅스 학동역점)
>  - N사 웹툰 : bs4와 request 및 json API활용 --> 웹툰정보, 웹툰회차정보 완료, 댓글크롤링 코드 구현완료
>  - D사 웹툰 : request 및 json API활용 --> 웹툰정보, 웹툰회차정보 완료, 댓글크롤링 코드구현/일부정보 수집완료
>  - 크롤링 관련 Trouble Shoot
>    - 웹툰 회차별 정보
>    - 웹툰 댓글정보
>  - 다음 모임까지 각자 할것
>    - 수집 데이터를 활용한 EDA 및 ipnyb, 혹은 DB화
>    - 적합한 모델 탐색 및 추천시스템 연구

### ◆ 2018-08-30(Thr)
> #### 주제 : 웹툰 관련 데이터 수집(크롤링 코드 연구)
>  (장소 : 스타벅스 논현역점)
>  - N사 웹툰 : bs4를 활용한 코드 작성 --> 웹툰정보, 웹툰회차 일부 코드 작성
>  - D사 웹툰 : request 및 json API활용 --> 웹툰정보, 웹툰회차정보 완료
>  - 데이터 간략 분석 및 모델회의(수집된 데이터 기준) 
>  - 다음 모임까지 각자 할것
>    - N사,D사 웹툰 회차별 댓글, 작가, 유저 크롤링

### ◆ 2018-08-28(Tue)
> #### 주제 : Data 확보 및 Data Storing 방식 설계
>  (장소 : 건대역 2번출구 엔젤리너스)
>  - 웹툰 제공 서비스 분석 및 데이터 수집 계획 수립
>  - DB 트리 및 스키마 계획(Draw ER Diagram)
>  - 크롤링 계획 수립
>  - Github Repository 생성
>  - 평일 중 : 크롤링 scrapy pipeline 구성 연구
>  - 다음 모임까지 각자 할것 :
>    - scrapy pipeline 연구
>    - Crawling File system 구성 및 테스트
>    - DATA EDA 개별 진행
>    - Recommend system 사전정보 수집
>    - Data alalysis fit model 정보 찾기 

### ◆ 2018-08-24(Fri)
> #### 주제 : 웹툰 분석 추천시스템 Project 결성
>  (장소: 성수역 패스트캠퍼스 C관)
>  - 프로젝트 팀 결성
>  - 프로젝트 주제 선정(웹툰 추천시스템)
>  - 프로젝트 데이터 간략 분석(N***, D**)
>  - 프로젝트 방향성 논의
>    - 데이터 수집(Crawling) --> 데이터 정형화 --> 모델링( & GradientBoost & NeuralNet) --> 추천서비스 --> 시범서비스화
